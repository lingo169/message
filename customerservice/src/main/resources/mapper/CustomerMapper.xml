<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lin.dao.CustomerMapper">
    <resultMap id="BaseResultMap" type="com.lin.po.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        <id column="ID" jdbcType="BIGINT" property="id"/>
        <result column="CUSTOMER_NO" jdbcType="VARCHAR" property="customerNo"/>
        <result column="NAMESPACE" jdbcType="VARCHAR" property="namespace"/>
        <result column="ROOM" jdbcType="VARCHAR" property="room"/>
        <result column="PORTRAIT" jdbcType="VARCHAR" property="portrait"/>
        <result column="PASSWORD" jdbcType="VARCHAR" property="password"/>
        <result column="OPENID" jdbcType="VARCHAR" property="openid"/>
        <result column="LEVEL_NO" jdbcType="VARCHAR" property="levelNo"/>
        <result column="CUSTOMER_NAME" jdbcType="VARCHAR" property="customerName"/>
        <result column="GENDER" jdbcType="VARCHAR" property="gender"/>
        <result column="NATION" jdbcType="VARCHAR" property="nation"/>
        <result column="CARD_TYPE" jdbcType="VARCHAR" property="cardType"/>
        <result column="CARD_NAME" jdbcType="VARCHAR" property="cardName"/>
        <result column="CARD_ID" jdbcType="VARCHAR" property="cardId"/>
        <result column="MOBILE" jdbcType="VARCHAR" property="mobile"/>
        <result column="EMAIL" jdbcType="VARCHAR" property="email"/>
        <result column="STATUS" jdbcType="VARCHAR" property="status"/>
        <result column="CREATE_ID" jdbcType="BIGINT" property="createId"/>
        <result column="CREATE_TIME" jdbcType="VARCHAR" property="createTime"/>
        <result column="UPDATE_ID" jdbcType="BIGINT" property="updateId"/>
        <result column="UPDATE_TIME" jdbcType="VARCHAR" property="updateTime"/>
        <result column="CUSTOMER_GROUP_ID" jdbcType="BIGINT" property="customerGroupId"/>
    </resultMap>
    <resultMap id="RelationshipMap" type="com.lin.po.Customer">
        <id column="ID" jdbcType="BIGINT" property="id"/>
        <result column="CUSTOMER_NO" jdbcType="VARCHAR" property="customerNo"/>
        <result column="NAMESPACE" jdbcType="VARCHAR" property="namespace"/>
        <result column="ROOM" jdbcType="VARCHAR" property="room"/>
        <result column="PORTRAIT" jdbcType="VARCHAR" property="portrait"/>
        <result column="PASSWORD" jdbcType="VARCHAR" property="password"/>
        <result column="OPENID" jdbcType="VARCHAR" property="openid"/>
        <result column="LEVEL_NO" jdbcType="VARCHAR" property="levelNo"/>
        <result column="CUSTOMER_NAME" jdbcType="VARCHAR" property="customerName"/>
        <result column="GENDER" jdbcType="VARCHAR" property="gender"/>
        <result column="NATION" jdbcType="VARCHAR" property="nation"/>
        <result column="CARD_TYPE" jdbcType="VARCHAR" property="cardType"/>
        <result column="CARD_NAME" jdbcType="VARCHAR" property="cardName"/>
        <result column="CARD_ID" jdbcType="VARCHAR" property="cardId"/>
        <result column="MOBILE" jdbcType="VARCHAR" property="mobile"/>
        <result column="EMAIL" jdbcType="VARCHAR" property="email"/>
        <result column="STATUS" jdbcType="VARCHAR" property="status"/>
        <result column="CREATE_ID" jdbcType="BIGINT" property="createId"/>
        <result column="CREATE_TIME" jdbcType="VARCHAR" property="createTime"/>
        <result column="UPDATE_ID" jdbcType="BIGINT" property="updateId"/>
        <result column="UPDATE_TIME" jdbcType="VARCHAR" property="updateTime"/>
        <collection property="customerRels" javaType="java.util.List" ofType="com.lin.po.CustomerRels">
            <result column="CUSTOMER_GROUP_ID" jdbcType="BIGINT" property="customerGroupId"/>
            <result column="CUSTOMER_REL_ID" jdbcType="BIGINT" property="customerRelId"/>
            <result column="REL_FLAG" jdbcType="VARCHAR" property="relFlag"/>
        </collection>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        ID, CUSTOMER_NO, NAMESPACE, ROOM, PORTRAIT, PASSWORD, OPENID, LEVEL_NO, CUSTOMER_NAME,
        GENDER, NATION, CARD_TYPE, CARD_NAME, CARD_ID, MOBILE, EMAIL, STATUS, CREATE_ID,
        CREATE_TIME, UPDATE_ID, UPDATE_TIME
    </sql>

    <select id="byCustomerNo" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        select
        <include refid="Base_Column_List"/>
        from cs_customer
        where CUSTOMER_NO = #{customerNo,jdbcType=VARCHAR}
    </select>
    <select id="selectRelationshipByCustomerId" parameterType="java.lang.String" resultMap="RelationshipMap">
        SELECT C.ID, C.CUSTOMER_NO, C.NAMESPACE, C.ROOM, C.PORTRAIT, C.PASSWORD, C.OPENID, C.LEVEL_NO, C.CUSTOMER_NAME,
            C.GENDER, C.NATION, C.CARD_TYPE, C.CARD_NAME, C.CARD_ID, C.MOBILE, C.EMAIL, C.STATUS, C.CREATE_ID,
            C.CREATE_TIME, C.UPDATE_ID, C.UPDATE_TIME,
        CR.CUSTOMER_GROUP_ID,CR.CUSTOMER_REL_ID,CR.REL_FLAG
        FROM cs_customer C LEFT JOIN cs_customer_rels CR ON C.id=CR.CUSTOMER_ID
        where C.CUSTOMER_NO = #{customerNo,jdbcType=VARCHAR}
  </select>
    <select id="countByIds" parameterType="java.lang.Long" resultType="INTEGER">
        select
        count(1)
        from cs_customer
        where ID in
        <foreach collection='ids' item='id' open='(' separator=',' close=')'>#{id,jdbcType=BIGINT}</foreach>
    </select>
    <select id="selectByEmail" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from cs_customer
        where EMAIL = #{email,jdbcType=VARCHAR}
    </select>

    <select id="listrels" parameterType="java.util.Map" resultMap="BaseResultMap">
        (select C.ID,C.CUSTOMER_NO,C.PORTRAIT,C.CUSTOMER_NAME,CR.CUSTOMER_GROUP_ID,CR.UPDATE_TIME from CS_CUSTOMER_RELS
        CR,cs_customer C
        where C.ID=CR.CUSTOMER_REL_ID AND CR.CUSTOMER_ID = #{customerId,jdbcType=BIGINT} AND CR.REL_FLAG='0' AND
        CR.STATUS IN ('0','1'))
        <if test='incloudGroupFlag==null or incloudGroupFlag == "1" '>
            UNION ALL
            (select CG.ID,CG.CUSTOMER_GROUP_NO,CG.PORTRAIT,CG.CUSTOMER_GROUP_NAME,CR.CUSTOMER_GROUP_ID,CR.UPDATE_TIME
            from CS_CUSTOMER_RELS
            CR,cs_customer_group CG where CG.ID=CR.CUSTOMER_GROUP_ID AND CR.CUSTOMER_ID = #{customerId,jdbcType=BIGINT}
            AND
            CR.REL_FLAG='1' AND CR.STATUS IN ('0','1'))
        </if>
        ORDER BY UPDATE_TIME DESC
        Limit #{pageNo,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}
    </select>
    <select id="listrelscount" parameterType="java.util.Map" resultType="INTEGER">
        select count(ID) from CS_CUSTOMER_RELS CR
        where CR.CUSTOMER_ID = #{customerId,jdbcType=BIGINT}
        <if test='incloudGroupFlag == "0" '>
            AND CR.REL_FLAG = '0'
        </if>
        AND CR.STATUS='1'
    </select>


    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from cs_customer
        where ID = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        delete from cs_customer
        where ID = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.lin.po.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        insert into cs_customer (ID, CUSTOMER_NO, NAMESPACE,
        ROOM, PORTRAIT, PASSWORD,
        OPENID, LEVEL_NO, CUSTOMER_NAME,
        GENDER, NATION, CARD_TYPE,
        CARD_NAME, CARD_ID, MOBILE,
        EMAIL, STATUS, CREATE_ID,
        CREATE_TIME, UPDATE_ID, UPDATE_TIME
        )
        values (#{id,jdbcType=BIGINT}, #{customerNo,jdbcType=VARCHAR}, #{namespace,jdbcType=VARCHAR},
        #{room,jdbcType=VARCHAR}, #{portrait,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR},
        #{openid,jdbcType=VARCHAR}, #{levelNo,jdbcType=VARCHAR}, #{customerName,jdbcType=VARCHAR},
        #{gender,jdbcType=VARCHAR}, #{nation,jdbcType=VARCHAR}, #{cardType,jdbcType=VARCHAR},
        #{cardName,jdbcType=VARCHAR}, #{cardId,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR},
        #{email,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, #{createId,jdbcType=BIGINT},
        #{createTime,jdbcType=VARCHAR}, #{updateId,jdbcType=BIGINT}, #{updateTime,jdbcType=VARCHAR}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.lin.po.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        insert into cs_customer
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="customerNo != null">
                CUSTOMER_NO,
            </if>
            <if test="namespace != null">
                NAMESPACE,
            </if>
            <if test="room != null">
                ROOM,
            </if>
            <if test="portrait != null">
                PORTRAIT,
            </if>
            <if test="password != null">
                PASSWORD,
            </if>
            <if test="openid != null">
                OPENID,
            </if>
            <if test="levelNo != null">
                LEVEL_NO,
            </if>
            <if test="customerName != null">
                CUSTOMER_NAME,
            </if>
            <if test="gender != null">
                GENDER,
            </if>
            <if test="nation != null">
                NATION,
            </if>
            <if test="cardType != null">
                CARD_TYPE,
            </if>
            <if test="cardName != null">
                CARD_NAME,
            </if>
            <if test="cardId != null">
                CARD_ID,
            </if>
            <if test="mobile != null">
                MOBILE,
            </if>
            <if test="email != null">
                EMAIL,
            </if>
            <if test="status != null">
                STATUS,
            </if>
            <if test="createId != null">
                CREATE_ID,
            </if>
            <if test="createTime != null">
                CREATE_TIME,
            </if>
            <if test="updateId != null">
                UPDATE_ID,
            </if>
            <if test="updateTime != null">
                UPDATE_TIME,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="customerNo != null">
                #{customerNo,jdbcType=VARCHAR},
            </if>
            <if test="namespace != null">
                #{namespace,jdbcType=VARCHAR},
            </if>
            <if test="room != null">
                #{room,jdbcType=VARCHAR},
            </if>
            <if test="portrait != null">
                #{portrait,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                #{password,jdbcType=VARCHAR},
            </if>
            <if test="openid != null">
                #{openid,jdbcType=VARCHAR},
            </if>
            <if test="levelNo != null">
                #{levelNo,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null">
                #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="gender != null">
                #{gender,jdbcType=VARCHAR},
            </if>
            <if test="nation != null">
                #{nation,jdbcType=VARCHAR},
            </if>
            <if test="cardType != null">
                #{cardType,jdbcType=VARCHAR},
            </if>
            <if test="cardName != null">
                #{cardName,jdbcType=VARCHAR},
            </if>
            <if test="cardId != null">
                #{cardId,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                #{mobile,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="status != null">
                #{status,jdbcType=VARCHAR},
            </if>
            <if test="createId != null">
                #{createId,jdbcType=BIGINT},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=VARCHAR},
            </if>
            <if test="updateId != null">
                #{updateId,jdbcType=BIGINT},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.lin.po.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        update cs_customer
        <set>
            <if test="customerNo != null">
                CUSTOMER_NO = #{customerNo,jdbcType=VARCHAR},
            </if>
            <if test="namespace != null">
                NAMESPACE = #{namespace,jdbcType=VARCHAR},
            </if>
            <if test="room != null">
                ROOM = #{room,jdbcType=VARCHAR},
            </if>
            <if test="portrait != null">
                PORTRAIT = #{portrait,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                PASSWORD = #{password,jdbcType=VARCHAR},
            </if>
            <if test="openid != null">
                OPENID = #{openid,jdbcType=VARCHAR},
            </if>
            <if test="levelNo != null">
                LEVEL_NO = #{levelNo,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null">
                CUSTOMER_NAME = #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="gender != null">
                GENDER = #{gender,jdbcType=VARCHAR},
            </if>
            <if test="nation != null">
                NATION = #{nation,jdbcType=VARCHAR},
            </if>
            <if test="cardType != null">
                CARD_TYPE = #{cardType,jdbcType=VARCHAR},
            </if>
            <if test="cardName != null">
                CARD_NAME = #{cardName,jdbcType=VARCHAR},
            </if>
            <if test="cardId != null">
                CARD_ID = #{cardId,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                MOBILE = #{mobile,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                EMAIL = #{email,jdbcType=VARCHAR},
            </if>
            <if test="status != null">
                STATUS = #{status,jdbcType=VARCHAR},
            </if>
            <if test="createId != null">
                CREATE_ID = #{createId,jdbcType=BIGINT},
            </if>
            <if test="createTime != null">
                CREATE_TIME = #{createTime,jdbcType=VARCHAR},
            </if>
            <if test="updateId != null">
                UPDATE_ID = #{updateId,jdbcType=BIGINT},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime,jdbcType=VARCHAR},
            </if>
        </set>
        where ID = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.lin.po.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Feb 14 21:33:13 CST 2022.
        -->
        update cs_customer
        set CUSTOMER_NO = #{customerNo,jdbcType=VARCHAR},
        NAMESPACE = #{namespace,jdbcType=VARCHAR},
        ROOM = #{room,jdbcType=VARCHAR},
        PORTRAIT = #{portrait,jdbcType=VARCHAR},
        PASSWORD = #{password,jdbcType=VARCHAR},
        OPENID = #{openid,jdbcType=VARCHAR},
        LEVEL_NO = #{levelNo,jdbcType=VARCHAR},
        CUSTOMER_NAME = #{customerName,jdbcType=VARCHAR},
        GENDER = #{gender,jdbcType=VARCHAR},
        NATION = #{nation,jdbcType=VARCHAR},
        CARD_TYPE = #{cardType,jdbcType=VARCHAR},
        CARD_NAME = #{cardName,jdbcType=VARCHAR},
        CARD_ID = #{cardId,jdbcType=VARCHAR},
        MOBILE = #{mobile,jdbcType=VARCHAR},
        EMAIL = #{email,jdbcType=VARCHAR},
        STATUS = #{status,jdbcType=VARCHAR},
        CREATE_ID = #{createId,jdbcType=BIGINT},
        CREATE_TIME = #{createTime,jdbcType=VARCHAR},
        UPDATE_ID = #{updateId,jdbcType=BIGINT},
        UPDATE_TIME = #{updateTime,jdbcType=VARCHAR}
        where ID = #{id,jdbcType=BIGINT}
    </update>
</mapper>